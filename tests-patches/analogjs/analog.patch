From 0e984df538adcf985fa7e7009302e8394dac5d95 Mon Sep 17 00:00:00 2001
From: sapphi-red <49056869+sapphi-red@users.noreply.github.com>
Date: Wed, 5 Feb 2025 14:08:37 +0900
Subject: [PATCH] temporary commit

---
 .../vite-plugin-nitro/src/lib/vite-nitro-plugin.spec.data.ts | 5 +++++
 packages/vite-plugin-nitro/src/lib/vite-plugin-nitro.ts      | 5 +++++
 2 files changed, 10 insertions(+)

diff --git a/packages/vite-plugin-nitro/src/lib/vite-nitro-plugin.spec.data.ts b/packages/vite-plugin-nitro/src/lib/vite-nitro-plugin.spec.data.ts
index 3b10942..49f5366 100644
--- a/packages/vite-plugin-nitro/src/lib/vite-nitro-plugin.spec.data.ts
+++ b/packages/vite-plugin-nitro/src/lib/vite-nitro-plugin.spec.data.ts
@@ -21,6 +21,11 @@ export const mockNitroConfig: NitroConfig = {
     publicDir: resolve('dist/analog/public'),
   },
   rootDir: '.',
+  imports: {
+    // FIXME: not sure why but unimport seems to inject `import { isError } from 'h3'`
+    // even when the file has `const isError = something`.
+    autoImport: false,
+  },
   scanDirs: ['src/server'],
   srcDir: 'src/server',
   prerender: {
diff --git a/packages/vite-plugin-nitro/src/lib/vite-plugin-nitro.ts b/packages/vite-plugin-nitro/src/lib/vite-plugin-nitro.ts
index 471ef7d..e65d451 100644
--- a/packages/vite-plugin-nitro/src/lib/vite-plugin-nitro.ts
+++ b/packages/vite-plugin-nitro/src/lib/vite-plugin-nitro.ts
@@ -81,6 +81,11 @@ export function nitro(options?: Options, nitroOptions?: NitroConfig): Plugin[] {
 
         nitroConfig = {
           rootDir,
+          imports: {
+            // FIXME: not sure why but unimport seems to inject `import { isError } from 'h3'`
+            // even when the file has `const isError = something`.
+            autoImport: false,
+          },
           preset: buildPreset,
           compatibilityDate: '2024-11-19',
           logLevel: nitroOptions?.logLevel || 0,
-- 
2.47.1

